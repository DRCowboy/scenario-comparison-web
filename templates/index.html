<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scenario Comparison</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .scenario { display: inline-block; vertical-align: top; margin-right: 20px; }
        table { border-collapse: collapse; width: 100%; max-width: 600px; }
        td, th { padding: 10px; text-align: left; border: 1px solid #ddd; }
        select { width: 200px; padding: 5px; }
        .error, .success { color: red; font-weight: bold; }
        .success { color: green; }
        pre { white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body>
    <h1>Scenario Comparison</h1>

    <!-- Upload Form -->
    <form method="post" enctype="multipart/form-data" action="/upload">
        <input type="file" name="file" accept=".xlsx">
        <input type="submit" value="Upload Excel File">
        {% if error %}
            <p class="error">{{ error }}</p>
        {% endif %}
        {% if success %}
            <p class="success">{{ success }}</p>
        {% endif %}
    </form>

    <!-- Comparison Form -->
    <form method="post" action="/">
        <div class="scenario">
            <h2>Scenario 1</h2>
            <table>
                <tr>
                    <td>Odr start:</td>
                    <td>
                        <select name="odr_start1">
                            {% for option in odr_starts %}
                                <option value="{{ option }}" {% if selected_odr_start == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Start color:</td>
                    <td>
                        <select name="start_color1">
                            {% for option in start_colors %}
                                <option value="{{ option }}" {% if selected_start_color == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>ODR Model:</td>
                    <td>
                        <select name="odr_model1">
                            {% for option in odr_models %}
                                <option value="{{ option }}" {% if selected_odr_model == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>ODR True/False:</td>
                    <td>
                        <select name="odr_true_false1">
                            {% for option in odr_true_false %}
                                <option value="{{ option }}" {% if selected_odr_true_false == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Location of High:</td>
                    <td>
                        <select name="location_high1">
                            {% for option in locations_high %}
                                <option value="{{ option }}" {% if selected_location_high1 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>High Level Hit:</td>
                    <td>
                        <select name="high_level_hit1">
                            {% for option in high_level_hits %}
                                <option value="{{ option }}" {% if selected_high_level_hit1 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>High Color:</td>
                    <td>
                        <select name="color_high1">
                            {% for option in colors_high %}
                                <option value="{{ option }}" {% if selected_color_high1 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Location of Low:</td>
                    <td>
                        <select name="location_low1">
                            {% for option in locations_low %}
                                <option value="{{ option }}" {% if selected_location_low1 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Low Level Hit:</td>
                    <td>
                        <select name="low_level_hit1">
                            {% for option in low_level_hits %}
                                <option value="{{ option }}" {% if selected_low_level_hit1 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Low Color:</td>
                    <td>
                        <select name="color1">
                            {% for option in colors %}
                                <option value="{{ option }}" {% if selected_color1 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
            </table>
        </div>

        <div class="scenario">
            <h2>Scenario 2</h2>
            <table>
                <tr>
                    <td>Location of High:</td>
                    <td>
                        <select name="location_high2">
                            {% for option in locations_high %}
                                <option value="{{ option }}" {% if selected_location_high2 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>High Level Hit:</td>
                    <td>
                        <select name="high_level_hit2">
                            {% for option in high_level_hits %}
                                <option value="{{ option }}" {% if selected_high_level_hit2 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>High Color:</td>
                    <td>
                        <select name="color_high2">
                            {% for option in colors_high %}
                                <option value="{{ option }}" {% if selected_color_high2 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Location of Low:</td>
                    <td>
                        <select name="location_low2">
                            {% for option in locations_low %}
                                <option value="{{ option }}" {% if selected_location_low2 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Low Level Hit:</td>
                    <td>
                        <select name="low_level_hit2">
                            {% for option in low_level_hits %}
                                <option value="{{ option }}" {% if selected_low_level_hit2 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Low Color:</td>
                    <td>
                        <select name="color2">
                            {% for option in colors %}
                                <option value="{{ option }}" {% if selected_color2 == option %}selected{% endif %}>{{ option }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
            </table>
        </div>

        <div style="clear: both; padding-top: 20px;">
            <input type="submit" value="Compare Scenarios">
        </div>
    </form>

    <!-- Results -->
    <h2>Results</h2>
    <pre>{{ result }}</pre>
</body>
</html>